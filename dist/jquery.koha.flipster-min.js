!function(E,t,M){"use strict";function P(n,i){var r=null;return function(){var t=this,e=arguments;null===r&&(r=setTimeout(function(){n.apply(t,e),r=null},i))}}var a,e,n=(a={},function(t){if(a[t]!==M)return a[t];var e=document.createElement("div").style,n=t.charAt(0).toUpperCase()+t.slice(1),i=(t+" "+["webkit","moz","ms","o"].join(n+" ")+n).split(" ");for(var r in i)if(i[r]in e)return a[t]=i[r];return a[t]=!1}),r="http://www.w3.org/2000/svg",j=function(){if(e!==M)return e;var t=document.createElement("div");return t.innerHTML="<svg/>",e=t.firstChild&&t.firstChild.namespaceURI===r},L=E(t),T=n("transform"),i={itemContainer:"ul",itemSelector:"li",start:"center",fadeIn:400,loop:!1,autoplay:!1,pauseOnHover:!0,style:"coverflow",spacing:-.6,click:!0,keyboard:!0,scrollwheel:!0,touch:!0,nav:!1,buttons:!1,buttonPrev:"Previous",buttonNext:"Next",onItemSwitch:!1},D={main:"flipster",active:"flipster--active",container:"flipster__container",nav:"flipster__nav",navChild:"flipster__nav__child",navItem:"flipster__nav__item",navLink:"flipster__nav__link",navCurrent:"flipster__nav__item--current",navCategory:"flipster__nav__item--category",navCategoryLink:"flipster__nav__link--category",button:"flipster__button",buttonPrev:"flipster__button--prev",buttonNext:"flipster__button--next",item:"flipster__item",itemCurrent:"flipster__item--current",itemPast:"flipster__item--past",itemFuture:"flipster__item--future",itemContent:"flipster__item__content"},N=new RegExp("\\b("+D.itemCurrent+"|"+D.itemPast+"|"+D.itemFuture+")(.*?)(\\s|$)","g"),S=new RegExp("\\s\\s+","g");E.fn.flipster=function(e){if("string"==typeof e){var n=Array.prototype.slice.call(arguments,1);return this.each(function(){var t=E(this).data("methods");return t[e]?t[e].apply(this,n):this})}var I=E.extend({},i,e);return this.each(function(){var t,f,a,n,p,o,l,c,u,v=E(this),s=[],h=0,d=!1,e=!1;function i(e){return e=e||"next",E('<button class="'+D.button+" "+("next"===e?D.buttonNext:D.buttonPrev)+'" role="button" />').html((t=e,n="next"===t?I.buttonNext:I.buttonPrev,"custom"!==I.buttons&&j?'<svg viewBox="0 0 13 20" xmlns="'+r+'" aria-labelledby="title"><title>'+n+'</title><polyline points="10,3 3,10 10,17"'+("next"===t?' transform="rotate(180 6.5,10)"':"")+"/></svg>":n)).on("click",function(t){b(e),t.preventDefault()});var t,n}function m(){v.css("transition",""),f.css("transition",""),p.css("transition","")}function g(r){var t,e;r&&(v.css("transition","none"),f.css("transition","none"),p.css("transition","none")),a=f.width(),f.height((e=0,p.each(function(){t=E(this).height(),e<t&&(e=t)}),e)),a?(n&&(clearInterval(n),n=!1),p.each(function(t){var e,n,i=E(this);i.attr("class",function(t,e){return e&&e.replace(N,"").replace(S," ")}),e=i.outerWidth(),0!==I.spacing&&i.css("margin-right",e*I.spacing+"px"),n=i.position().left,s[t]=-1*(n+e/2-a/2),t===p.length-1&&(_(),r&&setTimeout(m,1))})):n=n||setInterval(function(){g(r)},500)}function _(){var e,n,i,r=p.length;p.each(function(t){e=E(this),n=" ",t===h?(n+=D.itemCurrent,i=r+1):t<h?(n+=D.itemPast+" "+D.itemPast+"-"+(h-t),i=r-(h-t)):(n+=D.itemFuture+" "+D.itemFuture+"-"+(t-h),i=r-(t-h)),e.css("z-index",i).attr("class",function(t,e){return e&&e.replace(N,"").replace(S," ")+n})}),0<=h&&(a&&s[h]!==M||g(!0),T?f.css("transform","translateX("+s[h]+"px)"):f.css({left:s[h]+"px"})),function(){if(I.nav){var t=o.data("flip-category");c.removeClass(D.navCurrent),u.filter(function(){return E(this).data("index")===h||t&&E(this).data("category")===t}).parent().addClass(D.navCurrent)}}()}function b(t){var e=h;if(!(p.length<=1))return"prev"===t?0<h?h--:I.loop&&(h=p.length-1):"next"===t?h<p.length-1?h++:I.loop&&(h=0):"number"==typeof t?h=t:t!==M&&(h=p.index(t),I.loop&&e!=h&&(e==p.length-1&&h!=p.length-2&&(h=0),0==e&&1!=h&&(h=p.length-1))),o=p.eq(h),h!==e&&I.onItemSwitch&&I.onItemSwitch.call(v,p[h],p[e]),_(),v}function y(t){return I.autoplay=t||I.autoplay,clearInterval(d),d=setInterval(function(){var t=h;b("next"),t!==h||I.loop||clearInterval(d)},I.autoplay),v}function x(){return clearInterval(d),d=0,v}function w(t){return x(),I.autoplay&&t&&(d=-1),v}function C(){g(!0),v.hide().css("visibility","").addClass(D.active).fadeIn(I.fadeIn)}function k(){var s;if(f=v.find(I.itemContainer).addClass(D.container),!((p=f.find(I.itemSelector)).length<=1))return p.addClass(D.item).each(function(){var t=E(this);t.children("."+D.itemContent).length||t.wrapInner('<div class="'+D.itemContent+'" />')}),I.click&&p.on("click.flipster touchend.flipster",function(t){e||(E(this).hasClass(D.itemCurrent)||t.preventDefault(),b(this))}),I.buttons&&1<p.length&&(v.find("."+D.button).remove(),v.append(i("prev"),i("next"))),s={},!I.nav||p.length<=1||(l&&l.remove(),l=E('<ul class="'+D.nav+'" role="navigation" />'),u=E(""),p.each(function(t){var e=E(this),n=e.data("flip-category"),i=e.data("flip-title")||e.attr("title")||t,r=E('<a href="#" class="'+D.navLink+'">'+i+"</a>").data("index",t);if(u=u.add(r),n){if(!s[n]){var a=E('<li class="'+D.navItem+" "+D.navCategory+'">'),o=E('<a href="#" class="'+D.navLink+" "+D.navCategoryLink+'" data-flip-category="'+n+'">'+n+"</a>").data("category",n).data("index",t);s[n]=E('<ul class="'+D.navChild+'" />'),u=u.add(o),a.append(o,s[n]).appendTo(l)}s[n].append(r)}else l.append(r);r.wrap('<li class="'+D.navItem+'">')}),l.on("click","a",function(t){var e=E(this).data("index");0<=e&&(b(e),t.preventDefault())}),"after"===I.nav?v.append(l):v.prepend(l),c=l.find("."+D.navItem)),0<=h&&b(h),v}t={jump:b,next:function(){return b("next")},prev:function(){return b("prev")},play:y,stop:x,pause:w,index:k},v.data("methods",t),v.hasClass(D.active)||function(){var t;if(v.css("visibility","hidden"),k(),p.length<=1)v.css("visibility","");else{t=!!I.style&&"flipster--"+I.style.split(" ").join(" flipster--"),v.addClass([D.main,T?"flipster--transform":" flipster--no-transform",t,I.click?"flipster--click":""].join(" ")),I.start&&(h="center"===I.start?Math.floor(p.length/2):I.start),b(h);var e,n,i,r,a,o,s,l,c=v.find("img");if(c.length){var u=0;c.on("load",function(){++u>=c.length&&C()}),setTimeout(C,750)}else C();L.on("resize.flipster",P(g,400)),I.autoplay&&y(),I.pauseOnHover&&f.on("mouseenter.flipster",function(){d?w(!0):x()}).on("mouseleave.flipster",function(){-1===d&&y()}),e=v,I.keyboard&&(e[0].tabIndex=0,e.on("keydown.flipster",P(function(t){var e=t.which;37!==e&&39!==e||(b(37===e?"prev":"next"),t.preventDefault())},250))),function(t){if(I.scrollwheel){var e,n,i=!1,r=0,a=0,o=0,s=/mozilla/.test(navigator.userAgent.toLowerCase())&&!/webkit/.test(navigator.userAgent.toLowerCase());t.on("mousewheel.flipster wheel.flipster",function(){i=!0}).on("mousewheel.flipster wheel.flipster",P(function(t){clearTimeout(a),a=setTimeout(function(){o=r=0},300),t=t.originalEvent,o+=t.wheelDelta||-1*(t.deltaY+t.deltaX),Math.abs(o)<25&&!s||(r++,n!==(e=0<o?"prev":"next")&&(r=0),n=e,(r<6||r%3==0)&&b(e),o=0)},50)),L.on("mousewheel.flipster wheel.flipster",function(t){i&&(t.preventDefault(),i=!1)})}}(f),n=f,I.touch&&n.on({"touchstart.flipster":function(t){t=t.originalEvent,i=t.touches?t.touches[0].clientX:t.clientX,r=t.touches?t.touches[0].clientY:t.clientY},"touchmove.flipster":function(t){t=t.originalEvent,a=t.touches?t.touches[0].clientX:t.clientX,o=t.touches?t.touches[0].clientY:t.clientY,l=a-i,s=o-r,30<Math.abs(l)&&Math.abs(s)<100&&t.preventDefault()},"touchend.flipster touchcancel.flipster ":function(){l=a-i,s=o-r,30<Math.abs(l)&&Math.abs(s)<100&&b(0<l?"prev":"next")}})}}()})}}(jQuery,window),function(a,t,e){"use strict";a.extend({kohaFlipster:function(i){i.css&&a("<link>",{rel:"stylesheet",type:"text/css",href:i.css}).appendTo("head");var r=i.host||"";i.flipsters.forEach(function(n){a.getJSON(n.bibs).done(function(t){i.shuffle&&function(t){for(var e=t.length-1;0<e;e--){var n=Math.floor(Math.random()*(e+1)),i=t[e];t[e]=t[n],t[n]=i}}(t);var e=["<div>\n<ul>\n",t.map(function(t){return'<li>\n<a href="'+r+"/cgi-bin/koha/opac-detail.pl?biblionumber="+t[0]+'">\n<img src="'+t[2]+'" title="'+t[1]+'"/>\n</a>\n</li>'}).join("\n"),"</ul>\n</div>"].join("\n");n.flipster.fadeIn=0,a(n.selector).html(e).flipster(n.flipster)}).fail(function(t){console.log("Error loading "+n.bibs),console.log(t)})})}})}(jQuery,window);